---
title: "Climate and Carnivorous Plants of New Zealand"
author: "Emily Langmeyer"
date: "7/19/2019"
output: html_document
---

## Background information

Carnivorous plants live in difficult environments and have adapted themselves to thrive in restrictive conditions. They usually live in soil that is nutrient deficient, so each species has developed a trap for use in digesting external nitrogen sources, such as leaf litter and insects. 

In this project, I will look at the climate of New Zealand and the species of plants that grow there, and look for a correlation between the two. 

## Set Up

Before processing any data, download (or load from library) dplyr, ggplot, mapr and ENMeval. 

```{r, message=FALSE}
library(ggplot2)
library(dplyr)
library(mapr)
library(ENMeval)
```

## Data

Data was collected from iNaturalist, a database where citizen scientists post sightings of different organisms. I was able to find a data set called "Carnivorous plants of New Zealand." This data was downloaded from iNaturalist and converted into a CSV file. 

```{r}
plants <- read.csv('observations-58872.csv')
```

This data set has way more information then needed, so filter to just include latitude, longitude and scientific name. This will make it much easier to read the data set, and plot the map. Then we need to turn it into a dataframe so it can be graphed.

```{r}
plants2 = plants[,c('latitude', 'longitude', 'scientific_name')]
plants3 <- na.omit(plants2, cols="x")
plants4 <- filter(plants3, longitude >0)
plantsdf <- as.data.frame(plants4)

nz = map_data("nz")

ggplot() + 
  geom_polygon(data = nz, aes(x=long, y = lat, group = group), fill = NA, color = "black")+
  coord_fixed(1.1) +
  geom_point(data= plantsdf, aes(x=longitude, y=latitude), color =  "orange")
  
```
  

## Climate Data

Now that he plant data has been mapped, we can look at the climate map of New Zealand. Plotting BIO12, which is the annual mean precipitation, and BIO1, the annual mean temperature.

Here's the precipitation:
```{r}
clim = getData('worldclim', var= 'bio', res=5)
ext = extent(165, 180, -50, -30)

c2 = crop(clim, ext)
plot(c2[[12]], col=topo.colors(99))
```

And the temperature:
```{r}
clim = getData('worldclim', var= 'bio', res=5)
ext = extent(165, 180, -50, -30)

c2 = crop(clim, ext)
plot(c2[[1]], col=topo.colors(99))
```




## Analysis

Now that we have these all mapped out, we can see where each species grows on the islands versus the amount of precipitation and temperature. 

```{r, message=FALSE}
library(dplyr)
worldclim <- getData('worldclim', var = 'bio', res = 5)
worldclim2 <- extract(worldclim, plantsdf[,c('longitude','latitude')])
worldclimdf <- data.frame(worldclim2)
worldbio = worldclim2[,c('bio1', 'bio12')]
nzplant <- cbind(plantsdf,worldbio)

ggplot(data=nzplant, aes(x=bio12, y= scientific_name))+
  geom_point()+
  geom_line() +
  geom_smooth()

ggplot(data=nzplant, aes(x=bio1, y=scientific_name))+
  geom_point()+
  geom_line() +
  geom_smooth()
```


The graphs show that Drosera, commonly known as the Sundew, has many different species, but most grow best in middle precipitation environments. New Zealand does get a good amount of precipitation, but most sightings of the Drosera were in areas with between 1500 and 3500 cm of rain. Utricularia, commonly known as bladderworts, are underwater carnivorous plants, and are usually found in places with a lot of precipitation. 

For temperature, Utricularia are found in hotter places, which could be facitlitated by the fact that they live submerged. Drosera seem to be in cooler places, as they do not live inside water, but because New Zealand has a consistent climate, they are found over all three islands. 















